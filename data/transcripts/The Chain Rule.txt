 The chain rule is cool. Stat Quest? Yeah. Hello, I'm Josh Starmer and welcome to Stat Quest. Today we're going to talk about the chain rule. And it's going to be clearly explained. Note, this Stat Quest assumes that you are already familiar with the basic idea of a derivative and just want a deeper understanding of the chain rule. That said, let's do a super quick review. Imagine we collected these measurements from a bunch of people. On the X-axis, we measured how much they liked Stat Quest. And on the Y-axis, we measured awesomeness. We can then fit this orange parabola to the data. The equation for the parabola is, awesomeness equals likes Stat Quest squared. The derivative of this equation tells us the slope of the tangent line at any point along the curve. The slope of the tangent line tells us how quickly awesomeness is changing with respect to likes Stat Quest. We can calculate the derivative of awesomeness with respect to likes Stat Quest by using the power rule. The power rule tells us to multiply likes Stat Quest by the power, which is 2, and raise Stat Quest by the power, 2 minus 1. And since 2 minus 1 equals 1, and raising something by 1 is the same as omitting the power, we end up with 2 times likes Stat Quest. Okay, bam, that's the review. Now let's dive into the chain rule with a super simple example. Imagine we collected weight and height measurements from three people, and then we fit a line to the data. Now if someone tells us they weigh this much, we can use the green line to predict that they are this tall. Bam. Now imagine we collected height and shoe size measurements, and we fit a line to the data. Now if someone tells us that they are this tall, we can use the orange line to predict that this is their shoe size. Bam. Now if someone tells us that they weigh this much, then we can predict their height, and we can use the predicted height to predict shoe size. And if we change the value for weight, we see a change in shoe size. Bam. Now let's focus on this green line that represents the relationship between weight and height. We see that for every one unit increase in weight, there is a two unit increase in height. In other words, the slope with a line is two divided by one, which equals two. And since the slope is two, the derivative, the change in height, with respect to a change in weight, is two. Now since the slope with a green line is the same as its derivative, two, the equation for height is height equals the derivative of height with respect to weight times weight, which equals two times weight. Note, the equation for height has no intercept because the green line goes through the origin. Now let's focus on the orange line that represents the relationship between height and shoe size. In this case, we see that for every one unit increase in height, there is a one quarter unit increase in shoe size. And I admit that it's hard to see the one quarter unit increase in shoe size so just trust me. Anyway, because we go up one quarter unit for every one unit we go over, the slope is, one quarter divided by one, which equals one quarter. And since the slope is one quarter, the derivative or the change in shoe size, with respect to a change in height is one quarter. Now since the slope of the orange line is the same as its derivative, the equation for shoe size is. shoe size equals the derivative of shoe size with respect to height times height, which equals one quarter times height. But again, because the orange line goes through the origin, the equation for shoe size has no intercept. Now because weight can predict height and height can predict shoe size, we can plug the equation for height into the equation for shoe size. Now if we want to determine exactly how shoe size changes with respect to changes in weight, we can take the derivative of shoe size with respect to weight. And the derivative of the equation for shoe size with respect to weight is just the product of the two derivatives. In other words, because height connects weight to shoe size, the derivative of shoe size with respect to weight is the derivative of shoe size with respect to height times the derivative of height with respect to weight. This relationship is the essence of the chain rule. Plugging in numbers gives us one half. And that means for every one unit increase in weight, there is a one half unit increase in shoe size. Bam! Now let's look at a slightly more complicated example. Imagine we measured how hungry of bunch of people were and how long it had been since they last had a snack. As time since the last snack increases on the X-axis, people got hungerier and hungerier at a faster rate. So we fit an exponential line with intercept one half to the measurements to reflect the increasing rate of hunger. Then we measured how much people craved ice cream and how hungry they were. The hungerier someone was, the more they craved ice cream. But after a certain amount of hunger, the craving did not continue to increase very much. So we fit a square root function to the data to reflect how the increase in craving tapers off. Now if we want to see how the rate of craving ice cream changes with respect to the time since the last snack. Plugging the equation for hunger into the equation for craves ice cream gives us an equation without an obvious derivative. To convince yourself that taking the derivative of this is no fun at all, pause the video and give it a try. However, because hunger links time since last snack to craves ice cream, we can use the chain rule. To solve for this derivative. First the power rule tells us that the derivative of hunger with respect to the time since the last snack is two times time. Likewise the power rule tells us that the derivative of craves ice cream with respect to hunger is one divided by two times the square root of hunger. So with these two derivatives, the chain rule tells us that the derivative of craves ice cream with respect to time is the derivative of craves ice cream with respect to hunger times the derivative of hunger with respect to time since last snack. So we plug in the derivatives and plug in the equation for hunger and cancel out the twos and we get the derivative of craves ice cream with respect to time since last snack. This derivative tells us how quickly or slowly our craving for ice cream changes with respect to time. Double bam. In this last example it was obvious that hunger was the link between time since last snack and craves ice cream. And we had an equation for hunger in terms of time and an equation for craves ice cream in terms of hunger. However, usually these relationships are not so obvious. Instead of having two separate equations, we usually get the first equation jammed into the second. And when all you have is this, it's not so obvious how the chain rule applies. So we can talk about how to apply the chain rule in this situation. Let us scooch the equation to the left so we have room to work. Now, one thing we can do in this situation is look for things in the equation that can be put in parentheses. For example, the square root symbol can be replaced with parentheses. Now we can say that the stuff inside the parentheses is time squared plus one half. And craves ice cream can be rewritten as the square root of the stuff inside. Now the chain rule tells us thatak the derivative of craves ice cream with respect to time is the derivative of craves ice cream with respect to the stuff inside times the derivative of the stuff inside with respect to time. The Power Rule gives us the derivative of craves ice cream with respect to the stuff inside And the power rule gives us the derivative of the stuff inside with respect to time. Now we just plug the derivatives into the chain rule, and plug in the equation for the stuff inside, cancel out the twos, and we get the derivative of craves ice cream with respect to the time since last snack. And that's exactly what we got before. Bam! Now let's look at how the chain rule applies to the residual sum of squares, a commonly used loss function in machine learning. Note, if this does not make any sense to you, just imagine I said, now let's look at one last example. Imagine we measured someone's weight and height, and we wanted to fit this green line to the measurement. Now to keep things simple, let's assume we can only move the green line up and down. The equation for the green line is, height equals the intercept plus one times weight, and we can change the intercept, but to keep things simple, we can't change the slope which is set to one. If we set the intercept to zero, then this location on the green line is the predicted height, and we can calculate the residual, the difference between the observed height and the value predicted by the line, and we can plot the residual on this graph, which has the intercept on the x-axis, and the residual on the y-axis. If we change the intercept here, then we can see the change in the residual here. And because a common way to evaluate how good the green line fits the data is the squared residual, we can plot the squared residual here, where we have the residuals on the x-axis, and the squared residuals on the y-axis. Now, if we change the intercept here, then we change the residual here and here, and changing the residual here, changes the squared residual here. In order to find the value for the intercept that minimizes the squared residual, we are going to find the derivative of the squared residual, with respect to the intercept, and then we're going to find where the derivative equal zero, because given the function y equals the residual squared, the derivative is zero at the lowest point. The chain rule says that because the residual links the intercept to the squared residual, then the derivative of the squared residual, with respect to the intercept, is the derivative of the squared residual, with respect to the residual, times the derivative of the residual, with respect to the intercept. The power rule tells us that the derivative of the residual squared is just, two times the residual. So let's plug that in, to solve for the derivative of the residual, with respect to the intercept, we move the equation for the residual over here so we have room to work. Then we plug in the equation for the predicted height. Then, in order to remove these parentheses, we multiply everything inside by negative one. Now, the derivative of the residual, with respect to the intercept, is zero, because this term does not contain the intercept, plus negative one, because the derivative of the negative intercept, equals negative one, plus zero, because the last term does not contain the intercept. Now do the math, and we are left with negative one. And that makes sense, because the derivative is just the slope of the orange line. And by I, we can see that the slope of the orange line is negative one. So let's plug this derivative in here, and do a little math, and plug in the equation for the residual. Now we have the derivative for the residual squared, in terms of the intercept. Note, even instead of starting with separate equations for the residual, and the residual squared, we started with just the equation for the residual squared, with the equation for the predicted height jammed into it, then, just like before, we can use parentheses to help us out. In this case, we'll call everything between the outermost parentheses the stuff inside, which equals the observed minus the intercept minus one times weight. And that means the residual squared can be rewritten as, the square of the stuff inside. Now we can use the chain rule to determine the derivative of the residual squared with respect to the intercept. It's the derivative of the residual squared, with respect to the stuff inside, times the derivative of the stuff inside, with respect to the intercept, just like before, the derivative of the residual, with respect to the stuff inside is, 2 times the stuff inside, so we plug that into the chain rule. and the derivative of the stuff inside with respect to the intercept is negative 1. So we plug that into the chain rule. Now we just plug in the stuff inside, multiply 2 with negative 1, and we end up with the exact same derivative as before. Bam. Now we want to find the value for the intercept such that the derivative of the residual squared equals 0. So we plug in the observed height and the observed weight. Set the derivative equal to 0 and solve for the intercept. And at long last, we see that when the intercept equals 1, we minimize the squared residual. And we have the best fitting line. Triple Bam. Hooray! We've made it to the end of another exciting stack quest. If you like this stack quest and want to see more, please subscribe. And if you want to support stack quest, consider contributing to my Patreon campaign, becoming a channel member, buying one or two of the stack quest study gods, or a t-shirt, or a hoodie, or just donate. The links are in the description below. All right, until next time, quest on.